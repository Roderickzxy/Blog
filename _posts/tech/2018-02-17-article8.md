---
layout: post
title:  "hadoop-三种运行模式的总结"
crawlertitle: "关于hadoop的三种模式"
summary: "在apache官网阅读hadoop的三种模式之后的总结"
date:   2018-02-17 00:07:00 +0700
cataname: 积累，等待，蜕变
category: tech/2018-02-17
tags: 'tech-大数据'
author: Roderick
---
本文为阅读hadoop官网 [hdfs资料](http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/SingleCluster.html "hdfs资料") 关于hdfs的集群的搭建，单机，伪分布式，完全分布式的模式。


## 模式： ##
1. 单机模式（standalone）  
2. 伪分布式  
3. 完全分布式  

1.单机模式只启动一个java进程，并且直接操作本地的文件系统上。一般用来调试MapReduce程序。
hadoop默认以单机模式为配置，三个xml文件内容为空，下载编译好的版本后，直接使用bin/hadoop命令就可以使用了，hadoop会完全运行在本地，不需要和其他节点交互。  

2.伪分布式，用多个独立的java进程来运行hadoop的守护进程，比如namenode，datanode，jobtracker，tasktracker，secondarynamenode。运行在hadoop的文件系统上（hdfs）  
假如要使用伪分布式，则需要修改以下的配置：  
1. conf/hadoop-env.sh 配置JAVA_HOME  
2. core-site.xml 配置hdfs节点名称和地址  
3. hdfs-site.xml 配置hdfs节点存储目录，复制数量  

etc/hadoop/core-site.xml:  
{% highlight shell %}
<configuration>  
    <property>  
        <name>fs.defaultFS</name>  
        <value>hdfs://localhost:9000</value>  
    </property>  
</configuration>  
{% endhighlight %}  
etc/hadoop/hdfs-site.xml:  
{% highlight shell %}
<configuration>  
    <property>  
        <name>dfs.replication</name>  
        <value>1</value>  
    </property>  
</configuration>  
{% endhighlight %}  
首先需要格式化文件系统（我们使用新的硬盘也是需要格式化）：  
{% highlight shell %}
bin/hdfs namenode -format  
{% endhighlight %}  

开启hdfs文件系统：  
{% highlight shell %}
sbin/start-dfs.sh  
{% endhighlight %}  

文件日志默认为$HADOOP_HOME/logs  
使用界面看namenode的运行状态： [http://localhost:9870/](http://localhost:9870/ "http://localhost:9870/")  

关闭守护进程：  
{% highlight shell %}
sbin/stop-dfs.sh  
{% endhighlight %}  

hdfs的具体命令这里不做展示了。。

注意
hadoop可以在yarn上通过启动资源管理器，节点管理器来跑MapReduce，yarn相当于资源管理系统。假如要使用yarn，需要修改如下的配置：  
etc/hadoop/mapred-site.xml:  
{% highlight shell %}
<configuration>  
	<property>  
		<name>mapreduce.framework.name</name>  
		<value>yarn</value>  
	</property>  
</configuration>  
{% endhighlight %}   
etc/hadoop/yarn-site.xml:
{% highlight shell %}
<configuration>  
	<property>  
		<name>yarn.nodemanager.aux-services</name>  
		<value>mapreduce_shuffle</value>  
	</property>  
	<property>  
		<name>yarn.nodemanager.env-whitelist</name>  
		<value>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME</value>  
	</property>  
</configuration>  
{% endhighlight %}   
基于普通模式的条件下，启动yarn：  
{% highlight shell %}
sbin/start-yarn.sh  
{% endhighlight %}   
查看资源管理器的接口： [http://localhost:8088/](http://localhost:8088/ "http://localhost:8088/")  
然后可以运行MapReduce的作业  
停止守护进程：  
{% highlight shell %}
sbin/stop-yarn.sh  
{% endhighlight %}   

3.完全分布式，不同机器代表namenode，datanode等节点做集群。   